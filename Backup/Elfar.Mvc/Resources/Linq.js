function Grouping(key){this.key = key;if(arguments.length!==1){var arg=arguments[1];if(arg instanceof Array)this.add(arg);else if(arg instanceof Function){this._push=this.push;this.selector=arg;this.push=function(item){this._push(this.selector(item))}}}}Grouping.prototype=Array.prototype;Array.prototype.add=function(){var array;switch(arguments.length){case 0: return;case 1:var arg=arguments[0];if(arg instanceof Array) {array = arg;break}default:array=arguments;break}for(var i=0;i<array.length;i++)this.push(array[i])};Array.prototype.copy=function(selector){if(!selector)selector=function(i){return i};var array=[];for(var i=0;i<this.length;i++)array.push(selector(this[i],i));return array};var beyond={enumerable:{aggregate:function(_,__,___){if(_===null)throw'accumulator for aggregate() cannot be null';var $=function(o){_=__(_,o)};if(typeof _==='function'){__=_;_=beyond.$$(this[0]);$=function(o,i){if(i!==0)_=__(_,o)}}else if(!__)throw'accumulator for aggregate() cannot be null';else if(typeof __!=='function')throw'accumulator for aggregate() must be a function';else if(!___)___=function(){return _};else if(typeof ___!=='function')throw'selector for aggregate() must be a function';this.copy($);return beyond.$(_,___)},all:function(_){if(!_)throw 'predicate for all() cannot be null';var $=true;this.copy(function(o){if(!_(o))$=false});return $},any:function(_){if(!_)throw 'predicate for any() cannot be null';var $=false;this.copy(function(o){if(_(o))$=true});return $},average:function(_){return this.length===0?0:this.sum(_)/this.length},contains:function(_){return this.indexOf(_)!==-1},distinct:function(_){var $=[];return this.copy(function(o){var v=beyond.$(o,_);if($.indexOf(v)===-1){$.push(v);return v}})},first:function(_){if(!_)throw 'predicate for first() cannot be null';return this.copy(function(o){return beyond._$(o,_)})[0]},groupBy:function(_,__,___){if(!_)throw'key selector for groupBy() cannot be null';if(typeof _!=='function')throw'key selector for groupBy() must be a function';if(__&&typeof __!=='function')throw'element selector for groupBy() must be a function';if(___&&typeof ___!=='function')throw'result selector for groupBy() must be a function';var $={},g=[];this.copy(function(o){var v=_(o);if(!$[v]){g.push($[v]=new Grouping(v,__))}$[v].push(o)});if(___)return this.copy(function(o){return ___(o.key, o)});return g},max:function(_){if(_&&typeof _!=='function')throw'selector for max() must be a function';var $=-beyond.m;this.copy(function(o){var v=beyond.$(o,_);if(v>$)$=v});return $},min:function(_){if(_&&typeof _!=='function')throw'selector for min() must be a function';var $=beyond.m;this.copy(function(o){var v=beyond.$(o,_);if(v<$)$=v});return $},orderBy:function(_){if(_&&typeof _!=='function')throw'selector for orderBy() must be a function';return this.copy().sort(function(a,b){a=beyond.$(a,_);b=beyond.$(b,_);if(typeof a==='string'){for(var i=0;i<a.length;i++){var $=a.charCodeAt(i)-b.charCodeAt(i);if($===0)continue;return $}}return Number(a)-Number(b)})},orderByDescending:function(_){if(_&&typeof _!=='function')throw'selector for orderByDescending() must be a function';return this.orderBy(_).reverse()},select:function(_){if(!_)throw 'selector for select() cannot be null';return this.copy(function(o,i){return _(o,i)})},selectMany:function(_,__){if(!_)throw'selector for selectMany() cannot be null';if(__&&typeof __!=='function')throw'result selector for selectMany() must be a function';var $=[];this.copy(function(o,i){var a=_(o,i);if(a instanceof Array)for(var j=0;j<a.length;j++){var b=a[j];$.push(beyond.$(b,__))}});return $},skip:function(_){return this.copy().slice(_)},sum:function(_){var $=0;this.copy(function(o){var v=beyond.$(o,_);if(typeof v!=='number')throw 'The array item is not a number';$+=v});return $},take:function(_){return this.copy().slice(0,_)},where:function(_){if(!_)throw 'predicate for where() cannot be null';return this.copy(function(o){return beyond._$(o,_)})}},_$:function(_,$){if(_&&$)return $(_)},$:function(_,$){return beyond._$(_,$)||_},$$:function(_){if(typeof _==='object'){var $={};for(k in _)$[k]=_[k];return $}return _},m:Number(new Date(9999,12,31,23,59,59,999))};var p=Array.prototype;with(beyond.enumerable){p.aggregate=aggregate;p.all=all;p.any=any;p.average=average;p.contains=contains;p.distinct=distinct;p.groupBy=groupBy;p.max=max;p.min=min;p.orderBy=orderBy;p.orderByDescending=orderByDescending;p.select=select;p.selectMany=selectMany;p.skip=skip;p.sum=sum;p.take=take;p.where=where}