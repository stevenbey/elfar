Date.prototype.addDays=function(n){return(new Date).setDate(this.getDate()+n)};"use strict";var __extends=this.__extends||function(n,t){function r(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);r.prototype=t.prototype;n.prototype=new r},Elfar;(function(n){var u=function(){function n(){var n=this;this.addTab=function(t){var i=n.tabs;i.indexOf(t)===-1&&i.push(t);n.selectTab(t)};this.removeTab=function(t){var i=n.tabs,r=i.indexOf(t);i.remove(t);t.selected()&&i()[--r].selected(!0)};this.selectTab=function(t){var i;i=typeof t=="string"?n.tabs().first(function(n){return n.name===t}):t;ko.utils.arrayForEach(n.tabs(),function(n){return n.selected(!1)});i||(i=n.tabs()[0]);i.selected(!0)};this.tabs=ko.observableArray([])}return n.init=function(){console.log("Elfar.App initialising...");var t=new n;t.addTab(new o);ko.applyBindings(t);console.log("Elfar.App initialised")},Object.defineProperty(n,"path",{get:function(){return location.pathname},enumerable:!0,configurable:!0}),n}();n.App=u;var r=function(){function n(n,t,i){this.name=n;this.title=t;this._template=(i||n)+"-template"}return Object.defineProperty(n.prototype,"template",{get:function(){return this._template},enumerable:!0,configurable:!0}),n}(),f=function(n){function t(t,i){n.call(this,t,i);this.selected=ko.observable(!1)}return __extends(t,n),Object.defineProperty(t.prototype,"closeable",{get:function(){return!0},enumerable:!0,configurable:!0}),t}(r),o=function(n){function t(){var t=this;n.call(this,"dashboard","Dashboard");this.sections=ko.observableArray();$.get(u.path+"/Summaries",function(n){t.summaries=n.select(function(n){return new s(n)}).orderByDescending(function(n){return n.Date});t.sections.push(new c(t.summaries))});this.selected(!0)}return __extends(t,n),Object.defineProperty(t.prototype,"closeable",{get:function(){return!1},enumerable:!0,configurable:!0}),t}(f),s=function(){function n(n){$.extend(this,n);this.dateTime=new Date(n.Date+" "+n.Time)}return n}(),h=function(n){function t(t,i){n.call(this,t,i)}return __extends(t,n),t}(r),c=function(n){function r(r){n.call(this,"statistics","Statistics");this.items=ko.observableArray();var u=(new Date).setHours(0,0,0,0);this.items.push(new t(new i(90,r.where(function(n){return u<=n.dateTime.addDays(90)})),"term-tile"));this.items.push(new t(new i(30,r.where(function(n){return u<=n.dateTime.addDays(30)})),"term-tile"));this.items.push(new t(new i(7,r.where(function(n){return u<=n.dateTime.addDays(7)})),"term-tile"));this.items.push(new t(new i(1,r.where(function(n){return u<=n.dateTime.valueOf()})),"term-tile"));this.items.push(new t(null,"donut",0));this.items.push(new t(null,"donut",2));this.items.push(new t(null,"donut",1));this.items.push(new t(null,"donut",1));this.items.push(new t(null,"donut",1))}return __extends(r,n),r}(h),t=function(n){function t(t,i,r){r===void 0&&(r=1);n.call(this,null,null,i);this.content=t;this._size=r}return __extends(t,n),Object.defineProperty(t.prototype,"size",{get:function(){switch(this._size){case 0:return"large";case 2:return"wide";default:return"small"}},enumerable:!0,configurable:!0}),t}(r),e;(function(n){n[n.Large=0]="Large";n[n.Small=1]="Small";n[n.Wide=2]="Wide"})(e||(e={}));var i=function(n){function t(t,i){n.call(this,"term-tab",t===1?"Today":t+" days");this.data=ko.observableArray();this.data(i)}return __extends(t,n),Object.defineProperty(t.prototype,"count",{get:function(){return this.data().length},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"css",{get:function(){return this.count?"teal-bg clickable":"lightgrey-bg"},enumerable:!0,configurable:!0}),t}(f),l=function(){function n(){}return Object.defineProperty(n,"colours",{get:function(){return["#68217A","#A83A95","#571C75","#009CCC","#007ACC","#9ACD32","#F2700F"].concat(Highcharts.getOptions().colors)},enumerable:!0,configurable:!0}),n}(),a=function(){function n(){}return n}()})(Elfar||(Elfar={}));$(function(){return Elfar.App.init()});