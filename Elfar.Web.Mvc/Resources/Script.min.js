var generateHash=function(n){var t,i;if(n instanceof Array)return n.reduce(function(n,t){return n+generateHash(t)},"");if(n instanceof Date)return n.toString();if(n instanceof Object){t="";for(i in n)n.hasOwnProperty(i)&&(t+=generateHash(n[i])||"");return t}return n.toString()},__extends,Elfar;Array.prototype.groupBy=function(n,t,i){if(!n)throw"Argument cannot be null. Parameter name: keySelector";var r=[],u={};return this.forEach(function(i){var e=n(i),o=generateHash(e),f=u[o];f||(r.push(u[o]=f=[]),f.key=e);f.push(t?t(i):i)}),i&&r.forEach(function(n,t){r[t]=i(n.key,n)}),r};Array.prototype.takeWhile=function(n){for(var i,r=[],t=0;t<this.length;t++){if(i=this[t],!n(i,t))break;r.push(i)}return r};Date.prototype.addDays=function(n){return(new Date).setDate(this.getDate()+n)};__extends=this.__extends||function(n,t){function r(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);r.prototype=t.prototype;n.prototype=new r},function(n){var i=function(){function n(){var n=this;this.selectTab=function(t){ko.utils.arrayForEach(n.tabs(),function(n){return n.selected(!1)});t.selected(!0)};this.removeTab=function(t){var i=n.tabs.indexOf(t);n.tabs.remove(t);t.selected()&&n.tabs()[--i].selected(!0)};this.tabs=ko.observableArray([])}return n.init=function(){console.log("Elfar.App initialising...");var i=new n;i.tabs.push(new r);i.tabs.push(new t("test","Test"));ko.applyBindings(i)},Object.defineProperty(n,"path",{get:function(){return location.pathname},enumerable:!0,configurable:!0}),n}(),t,r;n.App=i;t=function(){function n(n,t){this.selected=ko.observable(!1);this.name=n;this.title=t}return Object.defineProperty(n.prototype,"disposable",{get:function(){return!0},enumerable:!0,configurable:!0}),n}();r=function(n){function t(){var t=this;n.call(this,"dashboard","Dashboard");this.ninety=ko.observableArray();this.thirty=ko.observableArray();this.seven=ko.observableArray();this.today=ko.observableArray();$.get(i.path+"/Summaries",function(n){t.summaries=n;var r=n.groupBy(function(n){return new Date(n.Date)}),i=(new Date).setHours(0,0,0,0);t.ninety(r.takeWhile(function(n){return i<=n.key.addDays(90)}));t.thirty(t.ninety().takeWhile(function(n){return i<=n.key.addDays(30)}));t.seven(t.thirty().takeWhile(function(n){return i<=n.key.addDays(7)}));t.today(t.seven().takeWhile(function(n){return i<=n.key.valueOf()}))});this.selected(!0)}return __extends(t,n),Object.defineProperty(t.prototype,"disposable",{get:function(){return!1},enumerable:!0,configurable:!0}),t}(t)}(Elfar||(Elfar={}));$(function(){return Elfar.App.init()});